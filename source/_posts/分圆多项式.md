---
title: 分圆多项式
date: 2019-05-11 22:10:43
tags: FHE
categories: 算法和研究
---
在基于RLWE困难问题的同态加密方案（BGV，BFV，CKKS等）中，都用到了分圆多项式（cyclotomic polynomial），遂花了些时间把它研究了一把。

先来看看分圆多项式的定义。在复数域$\mathbb{C}$上，$x^n - 1 = 0$有$n$个根，并且均匀的分布在单位圆上，即为单位圆的$n$个等分点。其表达式如下。
$$w_n^i = \cos(\frac{i}{n}2\pi) + i\sin(\frac{i}{n}2\pi),\quad i = 0, 1, ..., n-1$$
当$i$与$n$互质时的根$w\_n^i$称为$n$次本原单位根，根据欧拉定理，这样的根的个数为$\varphi(n)$。
既然叫本原单位根，那肯定有跟其它普通单位根不同的地方。这里的不同之处就是，对任何一个本原单位根求$0$到$n-1$次幂，都恰好能不重复的生成所有$n$个单位根。换句话说，所有$n$次单位根构成以某本原单位根为生成元的循环乘法群。因此，假设$\alpha = w\_n^i$为本原单位根，则所有$n$次单位根可表示为$1, \alpha, \alpha^2, ..., \alpha^{n-1}$。如前所述，一共有$\varphi(n)$个这样的本原单位根，记为$\alpha\_1, \alpha\_2, ..., \alpha\_{\varphi(n)}$。分圆多项式$\Phi_n(x)$就是以所有本原单位根为根的多项式，因此可表示为下式。
$$\Phi_n(x) = (x - \alpha_1)(x - \alpha_2)...(x - \alpha_{\varphi(n)})$$
这也体现了分圆多项式名称的含义，只要求出它的一个根，就可以通过这个根来生成单位圆的n个等分点。本原单位根的另一个特点是，对于所有正整数$k < n$，都有$\alpha^k \neq 1$，这很容易从它的定义中得出。

上述只是分圆多项式的一般定义。而分圆多项式的奇妙之处在于，它在有限域上也有类似的性质。在描述这个性质之前，先回顾一下有限域的相关知识。我们知道，以素数$p$为模的$\mathbb{Z}\_p$在普通加法和乘法下构成一个有限域，也记为$\mathbb{F}\_p$。每个素数$p$都有对应的原根$\beta$（通常为2，3，或5中的一个），而$\mathbb{F}\_p$中的非零元素恰好构成以$\beta$为生成元的循环乘法群，即$1, \beta, \beta^2, ..., \beta^{p-2}$。$\mathbb{F}\_p$中每个元素的**阶**定义为以它为生成元的循环乘法群中元素的个数，因此，原根的阶为$p-1$。另一方面也容易看出，$\beta^{p-1} = 1$而$\beta^n \neq 1 (n < p-1)$。对于$\mathbb{F}\_p$中非原根的其它元素，它的阶$d$一定是$p-1$的因子，即$d | (p-1)$。

回到之前的问题：那么有限域跟分圆多项式有什么关联呢？其关联在于，只要分圆多项式的阶$n$（注意-阶不是次数）在有限域$\mathbb{F}\_p$中存在对应的$n$阶元素，那么分圆多项式在$\mathbb{F}\_p$上也可以分解为以这些元素为根的一次因式乘积的形式。由$n$阶元素的定义，以其为生成元能生成$\mathbb{F}\_p$上的循环乘法群$1, \alpha, \alpha^2, ..., \alpha^{n-1}$。类似于复数域$\mathbb{C}$上的本原单位根，$n$阶元素在$\mathbb{F}\_p$上同样满足$\alpha^n = 1$而$\alpha^k \neq 1 (k < n)$。类似的，可以定义$\mathbb{F}\_p$上的$n$阶分圆多项式如下。
$$\Phi_n(x) = (x - \alpha_1)(x - \alpha_2)...(x - \alpha_{\varphi(n)})$$
虽然$\mathbb{F}\_p$上的$n$阶元素和$\mathbb{C}$上的$n$次本原单位根不同，但由它们生成的分圆多项式展开后却具有统一的形式。因此可以说，“分圆多项式是连接复数域和有限域的桥梁”。

另外一点需要注意的是，$\mathbb{F}\_p$上存在$n$阶元素的条件是$n | (p-1)$，即$n$阶分圆多项式在$\mathbb{F}\_p$上可分解的条件是$n$能整除$p-1$。在同态加密中的分圆多项式的阶通常采用2的幂的形式，如$2^m$，此时分圆多项式的形式为$\Phi(x) = x^{2^{m-1}} + 1$。